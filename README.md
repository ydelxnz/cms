# cms
# 影楼CMS全栈系统

## 项目概述

影楼CMS全栈系统是一个专为摄影工作室设计的综合管理平台，提供客户关系管理、预约安排、照片上传/管理、订单处理以及系统管理等功能。系统采用现代化的前端技术栈和简单高效的后端架构，适合小型到中型影楼使用。

## 系统架构

- **前端**: Next.js 15.3.1 + React 19 + TypeScript + Tailwind CSS
- **后端**: Next.js API Routes
- **数据存储**: 基于JSON文件的轻量级数据库系统
- **认证系统**: NextAuth.js
- **文件存储**: 本地文件系统

## 主要功能模块

### 1. 用户管理

- 多角色系统：管理员、摄影师、客户
- 用户注册、登录、资料管理
- 基于角色的权限控制
- 操作日志记录

### 2. 客户管理

- 客户信息记录
- 客户预约历史
- 客户照片管理

### 3. 摄影师管理

- 摄影师排班
- 工作量统计
- 照片上传

### 4. 预约管理

- 在线预约系统
- 预约状态跟踪
- 摄影师分配

### 5. 照片管理

- 照片上传与预览
- 相册分类整理
- 照片共享与下载
- 客户照片选择

### 6. 订单管理

- 订单创建与跟踪
- 支付状态管理
- 订单统计分析

### 7. 权限管理

- 基于角色的权限系统
- 自定义权限组
- 权限变更日志记录

### 8. 系统管理

- 操作日志查询
- 系统设置
- 数据备份

## 技术特点

1. **前后端一体化**: 使用Next.js实现前后端一体化开发
2. **响应式设计**: 适配PC端和移动端
3. **主题支持**: 支持亮色/暗色主题
4. **文件处理**: 支持大量照片的上传和处理
5. **权限系统**: 细粒度的权限控制
6. **日志系统**: 完整的操作日志记录

## 安装运行

### 前置条件

- Node.js 18+
- npm 或 yarn

### 安装步骤

1. 克隆代码库

```bash
git clone <repository-url>
cd cms-fullstack
```

2. 安装依赖

```bash
npm install
```

3. 初始化系统

```bash
npm run init-permissions
```

4. 启动开发服务器

```bash
npm run dev
```

5. 访问系统

在浏览器中打开 [http://localhost:3000](http://localhost:3000)

## 目录结构

```
cms-fullstack/
├── app/                     # Next.js应用目录
│   ├── (admin)/            # 管理员平台
│   ├── (client)/           # 客户平台
│   ├── (photographer)/     # 摄影师平台
│   ├── api/                # API路由
│   └── ...
├── components/             # UI组件
├── lib/                    # 工具库
│   ├── db.ts              # 数据库访问层
│   ├── auth.ts            # 认证相关
│   ├── services/          # 服务层
│   └── ...
├── public/                 # 静态资源
├── data/                   # 数据存储目录
├── scripts/                # 脚本文件
└── ...
```

## 主要依赖

- **next**: Next.js框架
- **react**: React库
- **next-auth**: 认证系统
- **tailwindcss**: CSS框架
- **lucide-react**: 图标库
- **date-fns**: 日期处理
- **zod**: 数据验证
- **react-hook-form**: 表单处理
- **axios**: HTTP客户端
- **zustand**: 状态管理

## 开发指南

### 创建新页面

1. 在对应的平台目录下创建页面文件
2. 导入所需组件和服务
3. 实现页面逻辑和UI
4. 添加到导航菜单

### 添加新API

1. 在`app/api`目录下创建新的API路由
2. 在`lib/db.ts`中添加对应的数据库操作函数
3. 在`lib/services`目录下添加对应的服务函数

### 权限管理

1. 使用脚本初始化权限和角色
2. 通过管理员平台的权限管理页面配置角色权限
3. 在API层进行权限校验

## 部署

### 生产环境构建

```bash
npm run build
npm start
```

### 环境变量

在`.env.local`文件中配置以下环境变量:

```
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=your_secret_key
```


